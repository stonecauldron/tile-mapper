(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     43039,       1127]
NotebookOptionsPosition[     41558,       1073]
NotebookOutlinePosition[     41911,       1089]
CellTagsIndexPosition[     41868,       1086]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<Tilemap`\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.686852636233423*^9, 3.6868526768797693`*^9}, {
  3.687415661266931*^9, 3.687415712463214*^9}, {3.6874161476266212`*^9, 
  3.687416150939269*^9}, {3.687416247883004*^9, 3.6874162725850363`*^9}, {
  3.6874164049643297`*^9, 3.687416443280958*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "cityFile", "=", "\"\<../data/processed/elements/pewter-city.txt\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6868526806117687`*^9, 3.686852720410575*^9}, {
  3.68718243635023*^9, 3.6871824552713327`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mapMatrix", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"StringPartition", "[", 
      RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
    RowBox[{"StringSplit", "[", 
     RowBox[{"Import", "[", "cityFile", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.687182457162867*^9, 3.687182534465003*^9}, {
  3.6871826220114098`*^9, 3.687182690008317*^9}, {3.6871827608958883`*^9, 
  3.68718278815853*^9}, {3.6871828290760717`*^9, 3.687182928987068*^9}, {
  3.687183737142066*^9, 3.687183752261606*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tileSet", "=", 
   RowBox[{
    RowBox[{"mapMatrix", "//", "Flatten"}], "//", "DeleteDuplicates"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.687182931688375*^9, 3.6871829494333477`*^9}, 
   3.687183049074501*^9, {3.687183694269998*^9, 3.687183817888946*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kernel", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", "0", "0"},
      {"0", "0", "1"},
      {"0", "1", "0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dependencyMatrix", "=", 
   RowBox[{"GenerateDependencyMatrix", "[", 
    RowBox[{"kernel", ",", "mapMatrix"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.68741682635679*^9, 3.687416843008521*^9}, {
  3.68741692543463*^9, 3.6874171842890177`*^9}, {3.6874172996625967`*^9, 
  3.687417335000289*^9}, {3.68750090511887*^9, 3.687500905867701*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"numberPredecessors", "=", 
   RowBox[{"Count", "[", 
    RowBox[{"kernel", ",", "1", ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tuples", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Tuples", "[", 
          RowBox[{"tileSet", ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"Table", "[", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "1", ",", "numberPredecessors"}], "}"}]}], 
         "]"}]}], ",", "1"}], "]"}], ",", 
     RowBox[{"{", "0", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"potentialPredecessors", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Fold", "[", 
       RowBox[{"Plus", ",", "0", ",", "#"}], "]"}], "&"}], "/@", "tuples"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.687454794583315*^9, 3.687454936171217*^9}, {
   3.687454976946755*^9, 3.6874550041175222`*^9}, {3.68745531353939*^9, 
   3.6874553941108637`*^9}, {3.6874554489328423`*^9, 3.687455469104596*^9}, {
   3.687455520098208*^9, 3.687455665534087*^9}, 3.6874557824965887`*^9, {
   3.68745584643579*^9, 3.687455847102544*^9}, {3.687456159972095*^9, 
   3.6874561699195213`*^9}, 3.6874562525375767`*^9, {3.687501955230691*^9, 
   3.6875020008131943`*^9}, {3.687502135408709*^9, 3.6875021644994497`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPreds", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "+", 
      RowBox[{"\"\<g\>\"", "*", "\[Alpha]"}]}], "&"}], "/@", 
    "potentialPredecessors"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"#", "->", 
    RowBox[{"Count", "[", 
     RowBox[{"dependencyMatrix", ",", "#", ",", "2"}], "]"}]}], "&"}], "/@", 
  "gPreds"}]}], "Input",
 CellChangeTimes->{{3.687456681280139*^9, 3.687456993839972*^9}, {
  3.687457071816143*^9, 3.687457100298574*^9}, {3.6874571493180113`*^9, 
  3.6874571518362713`*^9}, {3.687457215676435*^9, 3.687457217077931*^9}, {
  3.687457254879985*^9, 3.687457411745767*^9}, {3.687457451390647*^9, 
  3.687457455780396*^9}, {3.687457501180798*^9, 3.6874575650775013`*^9}, {
  3.6874576239892807`*^9, 3.687457667769842*^9}, {3.687457779377096*^9, 
  3.6874578568517036`*^9}, {3.687457963163948*^9, 3.687458006747409*^9}, {
  3.687458058409347*^9, 3.6874581046167717`*^9}, {3.687458224424652*^9, 
  3.687458262762993*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"\<\"g\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "41"}], ",", 
   RowBox[{
    RowBox[{"\<\"D\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\<\"T\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\<\"M\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"\<\"H\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\<\"e\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\<\"l\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\<\"R\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"2", " ", "\<\"g\"\>"}], "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "610"}], ",", 
   RowBox[{
    RowBox[{"\<\"D\"\>", "+", "\<\"g\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "60"}], ",", 
   RowBox[{
    RowBox[{"\<\"g\"\>", "+", "\<\"T\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "33"}], ",", 
   RowBox[{
    RowBox[{"\<\"g\"\>", "+", "\<\"M\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "34"}], ",", 
   RowBox[{
    RowBox[{"\<\"g\"\>", "+", "\<\"H\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "44"}], ",", 
   RowBox[{
    RowBox[{"\<\"e\"\>", "+", "\<\"g\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "7"}], ",", 
   RowBox[{
    RowBox[{"\<\"g\"\>", "+", "\<\"l\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "29"}], ",", 
   RowBox[{
    RowBox[{"\<\"g\"\>", "+", "\<\"R\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"2", " ", "\<\"D\"\>"}], "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\<\"D\"\>", "+", "\<\"T\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "2"}], ",", 
   RowBox[{
    RowBox[{"\<\"D\"\>", "+", "\<\"M\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "3"}], ",", 
   RowBox[{
    RowBox[{"\<\"D\"\>", "+", "\<\"H\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"\<\"D\"\>", "+", "\<\"e\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\<\"D\"\>", "+", "\<\"l\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\<\"D\"\>", "+", "\<\"R\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"2", " ", "\<\"T\"\>"}], "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"\<\"M\"\>", "+", "\<\"T\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"\<\"H\"\>", "+", "\<\"T\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "2"}], ",", 
   RowBox[{
    RowBox[{"\<\"e\"\>", "+", "\<\"T\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\<\"l\"\>", "+", "\<\"T\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\<\"R\"\>", "+", "\<\"T\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"2", " ", "\<\"M\"\>"}], "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\<\"H\"\>", "+", "\<\"M\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\<\"e\"\>", "+", "\<\"M\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\<\"l\"\>", "+", "\<\"M\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"\<\"M\"\>", "+", "\<\"R\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"2", " ", "\<\"H\"\>"}], "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"\<\"e\"\>", "+", "\<\"H\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\<\"H\"\>", "+", "\<\"l\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\<\"H\"\>", "+", "\<\"R\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"2", " ", "\<\"e\"\>"}], "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\<\"e\"\>", "+", "\<\"l\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\<\"e\"\>", "+", "\<\"R\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"2", " ", "\<\"l\"\>"}], "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"\<\"l\"\>", "+", "\<\"R\"\>", "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"2", " ", "\<\"R\"\>"}], "+", 
     RowBox[{"\<\"g\"\>", " ", "\[Alpha]"}]}], "\[Rule]", "0"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6874578182723227`*^9, 3.6874578573538218`*^9}, {
   3.6874579655899973`*^9, 3.687457997443054*^9}, 3.68745813037232*^9, 
   3.6874582276506443`*^9, 3.687458264847616*^9, 3.687500870404496*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"predecessorTilePairs", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"MapThread", "[", 
      RowBox[{"List", ",", 
       RowBox[{"{", 
        RowBox[{"dependencyMatrix", ",", "mapMatrix"}], "}"}], ",", "2"}], 
      "]"}], ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Count", "[", 
  RowBox[{"predecessorTilePairs", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", "\"\<g\>\""}], ",", "_"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.687500850128174*^9, 3.6875008590960197`*^9}, {
  3.687500917716277*^9, 3.6875010574285297`*^9}, {3.6875011114384003`*^9, 
  3.687501191277355*^9}, {3.687501417352913*^9, 3.6875014177861557`*^9}, {
  3.687501668974306*^9, 3.687501752580369*^9}, {3.6875017847195807`*^9, 
  3.6875018184671717`*^9}}],

Cell[BoxData["629"], "Output",
 CellChangeTimes->{
  3.687501753326386*^9, {3.687501788533457*^9, 3.687501819061901*^9}, 
   3.687502074640974*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"predecessor", "=", 
   RowBox[{"2", "\"\<g\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tileType", "=", "\"\<g\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Count", "[", 
  RowBox[{"predecessorTilePairs", ",", 
   RowBox[{"{", 
    RowBox[{"predecessor", ",", "tileType"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.687501938012829*^9, 3.687501943907295*^9}, {
  3.687502007590341*^9, 3.687502008676694*^9}, {3.687502076625505*^9, 
  3.687502077542075*^9}, {3.687502224708057*^9, 3.687502239142967*^9}, {
  3.687502289240926*^9, 3.687502289928135*^9}, {3.687502366180069*^9, 
  3.687502429940263*^9}, {3.687502464436267*^9, 3.6875025027264013`*^9}, {
  3.687502749867909*^9, 3.687502752061531*^9}}],

Cell[BoxData["610"], "Output",
 CellChangeTimes->{3.687501939994554*^9, 3.687502077971746*^9, 
  3.687502168162374*^9, 3.6875022290555887`*^9, 3.687502290277832*^9, 
  3.687502473673381*^9, 3.687502504996072*^9, 3.6875027526259537`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Count", "[", 
     RowBox[{"predecessorTilePairs", ",", 
      RowBox[{"{", 
       RowBox[{"predecessor", ",", "#"}], "}"}]}], "]"}], "&"}], "/@", 
   "tileSet"}], "\[Rule]", "tileSet"}]], "Input",
 CellChangeTimes->{{3.68750280963678*^9, 3.687502824468149*^9}, {
  3.6875028964759398`*^9, 3.687503002122452*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
   "610", ",", "7", ",", "3", ",", "2", ",", "4", ",", "0", ",", "3", ",", 
    "0"}], "}"}], "\[Rule]", 
  RowBox[{"{", 
   RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", ",", "\<\"M\"\>", 
    ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>", ",", "\<\"R\"\>"}], 
   "}"}]}]], "Output",
 CellChangeTimes->{3.687502817876815*^9, 3.687502969732136*^9, 
  3.687503004429595*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ProbabilityGivenPredecessor", "[", 
    RowBox[{
    "predecessorTilePairs_List", ",", "predecessor_", ",", "tileset_List"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{"predecessorTilePairs", ",", 
        RowBox[{"{", 
         RowBox[{"predecessor", ",", "#"}], "}"}]}], "]"}], "&"}], "/@", 
     "tileset"}], "\[Rule]", "tileset"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ProbabilityGivenPredecessor", "[", 
  RowBox[{"predecessorTilePairs", ",", "predecessor", ",", "tileSet"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.687503020802844*^9, 3.687503177763084*^9}, {
  3.687503211436647*^9, 3.687503310463024*^9}, {3.687503358456465*^9, 
  3.6875033740010033`*^9}, {3.6875034176430483`*^9, 3.6875034193937817`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
   "610", ",", "7", ",", "3", ",", "2", ",", "4", ",", "0", ",", "3", ",", 
    "0"}], "}"}], "\[Rule]", 
  RowBox[{"{", 
   RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", ",", "\<\"M\"\>", 
    ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>", ",", "\<\"R\"\>"}], 
   "}"}]}]], "Output",
 CellChangeTimes->{3.687503311244714*^9, 3.687503375394557*^9, 
  3.6875034222608547`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"probabilities", "=", 
  RowBox[{"AssociationThread", "[", 
   RowBox[{"potentialPredecessors", "->", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ProbabilityGivenPredecessor", "[", 
        RowBox[{"predecessorTilePairs", ",", "#", ",", "tileSet"}], "]"}], 
       "&"}], "/@", "potentialPredecessors"}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.687503388566413*^9, 3.687503561353855*^9}, {
  3.687503674908214*^9, 3.687503744801141*^9}, {3.687503860694213*^9, 
  3.6875038656110487`*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"0", "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{"\<\"g\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "41", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{"\<\"D\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{"\<\"T\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{"\<\"M\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "31", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{"\<\"H\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{"\<\"e\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{"\<\"l\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{"\<\"R\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "\<\"g\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "610", ",", "7", ",", "3", ",", "2", ",", "4", ",", "0", ",", "3", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"D\"\>", "+", "\<\"g\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "60", ",", "59", ",", "2", ",", "0", ",", "1", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"g\"\>", "+", "\<\"T\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "33", ",", "1", ",", "57", ",", "0", ",", "1", ",", "0", ",", "2", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"g\"\>", "+", "\<\"M\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "34", ",", "1", ",", "1", ",", "8", ",", "0", ",", "0", ",", "1", ",", 
       "2"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"g\"\>", "+", "\<\"H\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "44", ",", "0", ",", "1", ",", "0", ",", "28", ",", "0", ",", "1", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"e\"\>", "+", "\<\"g\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "7", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"g\"\>", "+", "\<\"l\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "29", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "20", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"g\"\>", "+", "\<\"R\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "2", ",", "0", ",", "0", ",", "0", ",", 
       "6"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "\<\"D\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "3", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"D\"\>", "+", "\<\"T\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"D\"\>", "+", "\<\"M\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "3", ",", "3", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"D\"\>", "+", "\<\"H\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "0", ",", "14", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"D\"\>", "+", "\<\"e\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"D\"\>", "+", "\<\"l\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"D\"\>", "+", "\<\"R\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "\<\"T\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "62", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"M\"\>", "+", "\<\"T\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "5", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"H\"\>", "+", "\<\"T\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "2", ",", "0", ",", "0", ",", "0", ",", "3", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"e\"\>", "+", "\<\"T\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"l\"\>", "+", "\<\"T\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "3", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"R\"\>", "+", "\<\"T\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "\<\"M\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "1", ",", "0", ",", "127", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"H\"\>", "+", "\<\"M\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"e\"\>", "+", "\<\"M\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"l\"\>", "+", "\<\"M\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"M\"\>", "+", "\<\"R\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "8", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "\<\"H\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "0", ",", "78", ",", "7", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"e\"\>", "+", "\<\"H\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "7", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"H\"\>", "+", "\<\"l\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"H\"\>", "+", "\<\"R\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "\<\"e\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"e\"\>", "+", "\<\"l\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"e\"\>", "+", "\<\"R\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "\<\"l\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"\<\"l\"\>", "+", "\<\"R\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "\<\"R\"\>"}], "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"g\"\>", ",", "\<\"D\"\>", ",", "\<\"T\"\>", 
       ",", "\<\"M\"\>", ",", "\<\"H\"\>", ",", "\<\"e\"\>", ",", "\<\"l\"\>",
        ",", "\<\"R\"\>"}], "}"}]}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.687503513194488*^9, 3.6875035619809*^9}, 
   3.687503745637723*^9, 3.687503866173748*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"testMap", "=", 
  RowBox[{"{", 
   RowBox[{"{", "0", "}"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"testMap", "[", 
  RowBox[{"[", 
   RowBox[{
    RowBox[{"-", "1"}], ",", 
    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6875038733418913`*^9, 3.687503876901989*^9}, {
  3.687503917608519*^9, 3.687503922438115*^9}, {3.6875041508210573`*^9, 
  3.6875043149781*^9}, {3.6875043632520723`*^9, 3.6875043732459784`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "0", "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6875038744944553`*^9, {3.687504178683918*^9, 3.6875042775301723`*^9}, {
   3.6875043129367743`*^9, 3.687504315487969*^9}, {3.687504364719143*^9, 
   3.687504370982085*^9}}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{
  3.6875038744944553`*^9, {3.687504178683918*^9, 3.6875042775301723`*^9}, {
   3.6875043129367743`*^9, 3.687504315487969*^9}, {3.687504364719143*^9, 
   3.6875043709867573`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"testMatrix", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\"\<a\>\"", ",", "\"\<a\>\"", ",", "\"\<a\>\""}], "}"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"paddedMatrix", "=", 
   RowBox[{"ArrayPad", "[", 
    RowBox[{"testMatrix", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "0"}], "}"}]}], "}"}], ",", "Null"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"paddedMatrix", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"indices", "=", 
  RowBox[{
   RowBox[{"Position", "[", 
    RowBox[{
     RowBox[{"Reverse", "[", 
      RowBox[{"Reverse", "/@", "kernel"}], "]"}], ",", "1"}], "]"}], "-", 
   "1"}]}]}], "Input",
 CellChangeTimes->{{3.687504400951527*^9, 3.6875045614216843`*^9}, {
   3.687504746126917*^9, 3.6875047868399267`*^9}, {3.68750489336761*^9, 
   3.68750489547191*^9}, {3.6875051477244577`*^9, 3.6875051587607737`*^9}, 
   3.687505246033515*^9, {3.687505285538929*^9, 3.6875052877777443`*^9}, {
   3.687505473849148*^9, 3.6875054746106377`*^9}, {3.687506138341464*^9, 
   3.6875062360407543`*^9}, {3.687506270648595*^9, 3.6875062908172703`*^9}, {
   3.687506415710599*^9, 3.6875064692966003`*^9}, {3.687506587255809*^9, 
   3.687506592964513*^9}, {3.6875096608509617`*^9, 3.687509669042091*^9}, {
   3.6875100127606783`*^9, 3.6875100155088987`*^9}, {3.687510122912476*^9, 
   3.6875101267396603`*^9}, {3.687510173465438*^9, 3.687510178638651*^9}, {
   3.687517473825287*^9, 3.687517475568214*^9}, {3.687517959565668*^9, 
   3.6875179831599703`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"Null", "Null", "Null", "Null", "Null"},
     {"Null", "Null", "Null", "Null", "Null"},
     {"Null", "Null", "\<\"a\"\>", "\<\"a\"\>", "\<\"a\"\>"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.687504469815106*^9, 3.687504483039339*^9}, {
   3.687504775464959*^9, 3.6875047873159447`*^9}, {3.6875048939130497`*^9, 
   3.687504895933983*^9}, 3.687505159514037*^9, 3.6875052465392303`*^9, 
   3.6875052882387667`*^9, 3.6875054753714113`*^9, {3.687506209896229*^9, 
   3.6875062365225487`*^9}, {3.6875062716594667`*^9, 3.68750629113024*^9}, 
   3.687506429196041*^9, 3.687506470034461*^9, 3.687510016189786*^9, {
   3.687510124768029*^9, 3.687510127202347*^9}, 3.68751017932878*^9, 
   3.687517475988147*^9, {3.6875179724557123`*^9, 3.6875179834708443`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.687504469815106*^9, 3.687504483039339*^9}, {
   3.687504775464959*^9, 3.6875047873159447`*^9}, {3.6875048939130497`*^9, 
   3.687504895933983*^9}, 3.687505159514037*^9, 3.6875052465392303`*^9, 
   3.6875052882387667`*^9, 3.6875054753714113`*^9, {3.687506209896229*^9, 
   3.6875062365225487`*^9}, {3.6875062716594667`*^9, 3.68750629113024*^9}, 
   3.687506429196041*^9, 3.687506470034461*^9, 3.687510016189786*^9, {
   3.687510124768029*^9, 3.687510127202347*^9}, 3.68751017932878*^9, 
   3.687517475988147*^9, {3.6875179724557123`*^9, 3.687517983482058*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Map", " ", "at", " ", "non", " ", "null", " ", "positions", " ", "or", 
    " ", "just", " ", "put", " ", "an", " ", "if"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"MapIndexed", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"index", ",", "predecessors"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"#1", "\[NotEqual]", "Null"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"index", "=", 
           RowBox[{"#2", "-", "indices"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"predecessors", "=", 
           RowBox[{"Extract", "[", 
            RowBox[{"paddedMatrix", ",", "index"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "predecessors"}], ",", "\[IndentingNewLine]",
          "Nothing"}], "]"}]}], "]"}], "&"}], "\[IndentingNewLine]", ",", 
    "paddedMatrix", ",", 
    RowBox[{"{", "2", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQrdW8YWN05WvHC+etN4PoW6WpO0D0lSvBB0D0ux/J
R8Hyv48dA9Hcs1bpxADpQ1NOgenIKh1HEO1x8ASY3mnu/jAWSE//xPsURPde
Ov4TRKv8SvoFohUe+gjEAeklwc6CINr8qElsIpB2clZPBNFrHmlngOhC7a2V
IHpVWmADiL5SPRFM16W4LQXRVf/TwXTX9+r1IDqNs2ATiF72130biN5ZkLEH
RD9/73AARH8KsbsPonMZop6BzU21/wiiVXIrvoHoSRtqwHTJElb2JCDdEfqB
C0QvPCUuAaKP3bfUAdEAaMyfJw==
  "]]
},
WindowSize->{686, 853},
WindowMargins->{{Automatic, -7}, {Automatic, 8}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 28, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 469, 9, 54, "Input"],
Cell[1030, 31, 247, 6, 32, "Input"],
Cell[1280, 39, 539, 12, 32, "Input"],
Cell[1822, 53, 296, 7, 32, "Input"],
Cell[2121, 62, 592, 14, 88, "Input"],
Cell[2716, 78, 1464, 36, 138, "Input"],
Cell[CellGroupData[{
Cell[4205, 118, 1007, 22, 54, "Input"],
Cell[5215, 142, 6007, 146, 201, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11259, 293, 813, 19, 75, "Input"],
Cell[12075, 314, 147, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12259, 322, 761, 15, 75, "Input"],
Cell[13023, 339, 236, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13296, 347, 374, 10, 32, "Input"],
Cell[13673, 359, 443, 11, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14153, 375, 831, 20, 117, "Input"],
Cell[14987, 397, 445, 11, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15469, 413, 541, 12, 96, "Input"],
Cell[16013, 427, 19334, 490, 960, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35384, 922, 468, 11, 54, "Input"],
Cell[35855, 935, 270, 6, 32, "Output"],
Cell[36128, 943, 227, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36392, 952, 1663, 37, 96, "Input"],
Cell[38058, 991, 1291, 26, 78, "Output"],
Cell[39352, 1019, 753, 14, 32, "Output"]
}, Open  ]],
Cell[40120, 1036, 1434, 35, 180, "Input"]
}
]
*)

